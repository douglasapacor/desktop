import {
  AppBar,
  Box,
  CssBaseline,
  Divider,
  Drawer,
  Icon,
  List,
  ListItem,
  ListItemButton,
  ListItemIcon,
  ListItemText,
  Toolbar,
} from "@mui/material";
import type { FC, ReactNode } from "react";
import settings from "../config/settings";
import { useAppStateContext } from "../state";

const Controller: FC<{ children?: ReactNode }> = ({ ...props }) => {
  const context = useAppStateContext();
  return (
    <Box sx={{ display: "flex", flexGrow: 1 }}>
      <CssBaseline />
      <AppBar
        position="fixed"
        sx={{
          width: `calc(100% - ${settings.drawer.width}px)`,
          ml: `${settings.drawer.width}px`,
        }}
      >
        <Toolbar sx={{ background: settings.colors.primary }}></Toolbar>
      </AppBar>
      <Drawer
        slotProps={{
          paper: {
            sx: {
              background: settings.colors.secondary,
            },
          },
        }}
        sx={{
          width: 240,
          flexShrink: 0,
          "& .MuiDrawer-paper": {
            width: 240,
            boxSizing: "border-box",
          },
        }}
        variant="permanent"
        anchor="left"
      >
        <Toolbar
          sx={{
            background: settings.colors.primary,
            display: "flex",
            justifyContent: "center",
          }}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            xmlSpace="preserve"
            width={settings.drawer.logo.width}
            version="1.1"
            shapeRendering="geometricPrecision"
            textRendering="geometricPrecision"
            imageRendering="optimizeQuality"
            fillRule="evenodd"
            clipRule="evenodd"
            viewBox="0 0 6759.12 3022.82"
            xmlnsXlink="http://www.w3.org/1999/xlink"
          >
            <defs>
              <linearGradient
                id="id0"
                gradientUnits="userSpaceOnUse"
                x1="1181.49"
                y1="-18867.44"
                x2="1488.67"
                y2="-15500.03"
              >
                <stop offset="0" stopOpacity="1" stopColor="#2D3269" />
                <stop offset="0.541176" stopOpacity="1" stopColor="#1F204D" />
                <stop offset="1" stopOpacity="1" stopColor="#141525" />
              </linearGradient>
              <linearGradient
                id="id1"
                gradientUnits="userSpaceOnUse"
                x1="55.5"
                y1="-18867.44"
                x2="195.19"
                y2="-15500.03"
              >
                <stop offset="0" stopOpacity="1" stopColor="#2D3269" />
                <stop offset="0.541176" stopOpacity="1" stopColor="#1F204D" />
                <stop offset="1" stopOpacity="1" stopColor="#141525" />
              </linearGradient>
              <linearGradient
                id="id2"
                gradientUnits="userSpaceOnUse"
                x1="3574.73"
                y1="-24317.34"
                x2="3858.56"
                y2="-19977.22"
              >
                <stop offset="0" stopOpacity="1" stopColor="#2D3269" />
                <stop offset="0.541176" stopOpacity="1" stopColor="#1F204D" />
                <stop offset="1" stopOpacity="1" stopColor="#141525" />
              </linearGradient>
            </defs>
            <g id="Layer_x0020_1">
              <metadata id="CorelCorpID_0Corel-Layer" />
              <g id="_2005872100096">
                <polygon
                  fill="url(#id0)"
                  fillRule="nonzero"
                  points="3282.82,2337.64 2404.36,2337.64 1898.11,1369.82 2002.34,1692.43 1932.85,2337.64 1064.31,2337.64 1312.46,0.01 2146.27,0.02 2692.2,1012.5 2587.98,709.75 2662.43,0.02 3530.98,0.02 "
                />
                <path
                  fill="url(#id1)"
                  fillRule="nonzero"
                  d="M880.69 2337.64l-878.49 0c59.56,-550.91 233.25,-2203.63 248.15,-2337.63l873.52 0.01 -243.18 2337.62z"
                />
                <path
                  fill="url(#id2)"
                  fillRule="nonzero"
                  d="M3709.65 0.02l992.63 0c789.14,0 947.95,421.88 888.39,913.21 -29.79,243.2 -163.78,496.3 -436.75,585.65l591.65 1514.02 -908.25 0 -694.09 -1852.96 216.58 0 342.47 0c119.11,0 148.9,-117.67 153.86,-177.23 9.93,-109.19 -79.41,-178.68 -178.68,-178.68l-382.16 0 -38.47 324.42 -164.78 0 126.79 317.13 -105.44 892.05 -646.95 0 243.2 -2337.62z"
                />
                <path
                  fill="#0792D4"
                  fillRule="nonzero"
                  d="M5485.93 2200.63l320.27 803.99c0,0 411.93,-719.66 952.92,-962.85l-759.35 -292.81c4.97,-4.99 -280.61,99.3 -513.84,451.67z"
                />
                <path
                  fill="#2B6994"
                  fillRule="nonzero"
                  d="M5855.84 3014.54c0,0 248.15,-446.68 674.97,-744.47l213.41 213.41c0,0 -441.7,138.96 -888.38,531.06z"
                />
                <path
                  fill="#334D7B"
                  fillRule="nonzero"
                  d="M5920.37 3009.57c0,0 307.71,-248.16 640.23,-362.32l89.35 138.96c4.95,0.02 -436.77,109.21 -729.59,223.36z"
                />
                <path
                  fill="#1373BA"
                  fillRule="nonzero"
                  stroke="#1373BA"
                  strokeWidth="7.6"
                  strokeMiterlimit="22.9256"
                  d="M541.62 2739.93c0,54.04 -12.47,102.07 -37.37,143.83 -24.93,41.86 -59.89,73.6 -104.92,95.13 -45.04,21.53 -98.35,32.29 -159.8,32.29l-234.74 0 106.35 -456.6 200.27 0c75.79,0 133.19,16.2 171.99,48.7 38.79,32.5 58.21,78.05 58.21,136.65zm-160.97 10.44c0,-29.45 -8.64,-51.52 -25.65,-66.21 -17.12,-14.66 -43.35,-21.95 -78.7,-21.95l-38.92 0 -55.81 241.34 50.91 0c46.35,0 82.64,-13.71 108.75,-41.2 26.25,-27.51 39.42,-64.8 39.42,-111.99zm576.82 -88.16l-161.82 0 -15.09 66.53 151.63 0 -24.9 107.64 -151.64 0 -15.8 67.18 173.07 0 -25.28 107.63 -324.58 0 106.35 -456.59 313.33 0 -25.27 107.62zm388.78 20.98c-24.79,-12.51 -46.94,-21.31 -66.58,-26.43 -19.64,-5.11 -39.4,-7.61 -59.29,-7.61 -15.94,0 -28.51,3.04 -37.74,9.15 -9.22,6.18 -13.9,14.24 -13.9,24.13 0,9.34 3.72,17.4 11.27,24.13 7.41,6.84 23.58,16.42 48.37,28.69 39.77,19.14 67.55,38.83 83.38,59.05 15.78,20.32 23.72,46.1 23.72,77.3 0,29.45 -9.13,55.76 -27.21,78.91 -18.2,23.16 -43.22,40.34 -75.1,51.64 -31.98,11.19 -69.83,16.86 -113.54,16.86 -31.87,0 -61.56,-3.26 -89.34,-9.68 -27.66,-6.53 -51.98,-14.79 -72.82,-25.01l26.36 -112.64c44.67,29.9 89.94,44.9 135.81,44.9 36.42,0 54.75,-11.84 54.75,-35.42 0,-10.66 -4.56,-19.58 -13.55,-26.65 -8.99,-7.06 -24.79,-15.32 -47.54,-24.68 -37.84,-16.1 -64.91,-34.24 -81.2,-54.24 -16.28,-20.12 -24.42,-45.79 -24.42,-76.98 0,-29.47 8.85,-56.2 26.7,-80.01 17.74,-23.92 42.05,-41.86 72.93,-53.82 30.91,-12.06 66.72,-18.05 107.45,-18.05 32.22,0 61.2,2.6 86.83,7.93 25.65,5.33 48.88,11.42 69.58,18.28l-24.91 110.23zm561.15 56.73c0,54.04 -12.46,102.07 -37.36,143.83 -24.92,41.86 -59.9,73.6 -104.93,95.13 -45.04,21.53 -98.34,32.29 -159.78,32.29l-234.76 0 106.36 -456.6 200.26 0c75.82,0 133.2,16.2 172,48.7 38.8,32.5 58.2,78.05 58.2,136.65zm-160.95 10.44c0,-29.45 -8.64,-51.52 -25.65,-66.21 -17.11,-14.66 -43.34,-21.95 -78.69,-21.95l-38.94 0 -55.8 241.34 50.9 0c46.37,0 82.66,-13.71 108.78,-41.2 26.22,-27.51 39.4,-64.8 39.4,-111.99zm576.81 -88.16l-161.81 0 -15.1 66.53 151.63 0 -24.91 107.64 -151.63 0 -15.8 67.18 173.06 0 -25.27 107.63 -324.59 0 106.36 -456.59 313.32 0 -25.26 107.62zm263.86 348.97l80.02 -344.4 -104.93 14.34 24.21 -101.96 258.94 -32.4 -108.76 464.43 -149.49 0zm687.03 -282.01c0,30.77 -4.42,60.88 -13.3,90.12 -8.98,29.37 -22.04,56.86 -39.51,82.64 -17.49,25.88 -39.18,47.94 -65.04,66.41 -26,18.5 -52.69,31.42 -80.01,38.83 -27.44,7.5 -59.65,11.18 -96.56,11.18 -20.58,0 -40.46,-1.63 -59.87,-4.77 -19.27,-3.16 -34.85,-6.85 -46.84,-11.09l22.52 -102.08c9.36,5.11 22.88,9.47 40.72,13.26 17.75,3.71 34.87,5.56 51.16,5.56 69.1,0 112.95,-34.69 131.63,-104.16l-1.44 0c-14.97,14.25 -29.71,24.25 -44.2,29.79 -14.5,5.66 -31.49,8.48 -50.92,8.48 -34.83,0 -63.58,-11.84 -86.46,-35.55 -22.76,-23.69 -34.26,-54.68 -34.26,-92.84 0,-32.71 8.75,-63.26 26,-91.65 17.38,-28.35 40.71,-50.01 70.18,-64.89 29.48,-14.89 63.01,-22.31 100.38,-22.31 54.25,0 97.12,16.44 128.64,49.37 31.49,32.94 47.19,77.51 47.19,133.72zm-138.57 -33.48c0,-13.04 -3.83,-24.23 -11.5,-33.71 -7.54,-9.45 -17.25,-14.12 -28.86,-14.12 -14.49,0 -26.61,6.41 -36.31,19.23 -9.69,12.94 -14.59,28.04 -14.59,45.45 0,13.82 3.6,25.11 10.65,33.81 7.19,8.69 16.65,13.04 28.27,13.04 14.73,0 27.18,-5.87 37.26,-17.51 10.06,-11.74 15.08,-27.07 15.08,-46.2zm157.15 201.55c0,-33.7 10.41,-61.64 31.26,-83.59 20.83,-22.08 52.93,-37.19 96.17,-45.24 -15.2,-7.6 -27.68,-19.77 -37.62,-36.52 -9.81,-16.63 -14.73,-34.79 -14.73,-54.36 0,-25.11 7.54,-47.61 22.65,-67.62 15.1,-19.99 36.77,-35.55 64.8,-46.53 28.02,-11.1 61.2,-16.64 99.28,-16.64 55.68,0 98.93,10.75 129.7,32.18 30.66,21.52 46.11,51.1 46.11,88.71 0,28.92 -10.29,53.7 -30.89,74.14 -20.6,20.54 -50.19,35.11 -88.74,43.58 24.06,9.37 42.38,22.41 54.86,39.25 12.57,16.86 18.78,36.74 18.78,59.59 0,26.09 -8.26,49.24 -24.79,69.68 -16.41,20.33 -40.11,36.08 -71.02,47.49 -30.91,11.32 -68.02,16.96 -111.5,16.96 -36.78,0 -69.11,-5.09 -97.14,-15.43 -27.91,-10.22 -49.47,-24.67 -64.57,-43.25 -15.08,-18.49 -22.63,-39.35 -22.63,-62.42l0.02 0zm141.45 -14.88c0,15 4.79,26.43 14.25,34.24 9.47,7.83 21.56,11.75 36.29,11.75 17.62,0 31.75,-5.22 42.65,-15.65 10.89,-10.55 16.28,-23.82 16.28,-39.79 0,-14.68 -4.55,-26.09 -13.65,-34.47 -9.11,-8.37 -21.45,-12.49 -36.9,-12.49 -17.72,0 -31.96,4.99 -42.75,14.87 -10.79,9.9 -16.17,23.82 -16.17,41.54zm66.72 -189.92c0,14.66 3.95,25.44 12.09,32.07 8.02,6.73 18.44,10.11 31.01,10.11 14.49,0 26.49,-4.89 35.8,-14.68 9.36,-9.79 14.03,-21.63 14.03,-35.43 0,-14.79 -3.83,-25.89 -11.37,-33.26 -7.66,-7.52 -18.09,-11.21 -31.37,-11.21 -15.22,0 -27.42,4.79 -36.55,14.26 -9.1,9.46 -13.64,22.17 -13.64,38.14l0 0.02zm634.45 36.73c0,30.77 -4.45,60.88 -13.31,90.12 -8.98,29.37 -22.04,56.86 -39.52,82.64 -17.5,25.88 -39.16,47.94 -65.04,66.41 -25.99,18.5 -52.69,31.42 -80.01,38.83 -27.43,7.5 -59.64,11.18 -96.54,11.18 -20.6,0 -40.49,-1.63 -59.88,-4.77 -19.28,-3.16 -34.86,-6.85 -46.84,-11.09l22.51 -102.08c9.36,5.11 22.88,9.47 40.74,13.26 17.72,3.71 34.85,5.56 51.15,5.56 69.08,0 112.94,-34.69 131.63,-104.16l-1.45 0c-14.98,14.25 -29.71,24.25 -44.2,29.79 -14.48,5.66 -31.49,8.48 -50.91,8.48 -34.85,0 -63.6,-11.84 -86.48,-35.55 -22.73,-23.69 -34.24,-54.68 -34.24,-92.84 0,-32.71 8.75,-63.26 25.98,-91.65 17.39,-28.35 40.74,-50.01 70.2,-64.89 29.46,-14.89 63,-22.31 100.38,-22.31 54.25,0 97.11,16.44 128.64,49.37 31.49,32.94 47.2,77.51 47.2,133.72zm-138.58 -33.48c0,-13.04 -3.84,-24.23 -11.52,-33.71 -7.54,-9.45 -17.25,-14.12 -28.85,-14.12 -14.49,0 -26.6,6.41 -36.29,19.23 -9.71,12.94 -14.61,28.04 -14.61,45.45 0,13.82 3.61,25.11 10.66,33.81 7.19,8.69 16.64,13.04 28.26,13.04 14.73,0 27.19,-5.87 37.27,-17.51 10.04,-11.74 15.08,-27.07 15.08,-46.2z"
                />
              </g>
            </g>
          </svg>
        </Toolbar>

        <Divider />

        <List>
          {Object.entries(settings.drawer.list.items).map((item, index) => (
            <ListItem key={`drawer-item-${index}`} disablePadding>
              <ListItemButton
                onClick={() => {
                  context.view.setCurrent(item[0]);
                }}
              >
                <ListItemIcon>
                  <Icon sx={{ color: settings.drawer.list.color }}>
                    {item[1].icon}
                  </Icon>
                </ListItemIcon>
                <ListItemText
                  sx={{ color: settings.drawer.list.color }}
                  primary={item[1].label}
                />
              </ListItemButton>
            </ListItem>
          ))}
        </List>
      </Drawer>
      <Box component="main" sx={{ flexGrow: 1, bgcolor: "background.default" }}>
        <Toolbar />
        <div
          style={{
            overflow: "hidden",
            position: "relative",
          }}
        >
          {props.children}
        </div>
      </Box>
    </Box>
  );
};

export default Controller;
